
{function MainPage()
{}
MainPage.ElementIDs={MainTabStripID:"mainTabStrip",TopAdPaneID:"TopAdPane",TopAdIFrameID:"TopAdIFrame",RightAdIFrameID:"RightAdIFrame",LeftAdIFrameID:"LeftAdIFrame",RightAdPaneID:"RightAdPane",LeftAdPaneID:"LeftAdPane",DocumentToolbarID:"ctrlDocViewerBar",PageItemCoverID:"pageItemCover",PageItemHelpID:"pageItemHelp",PageItemSearchID:"pageItemSearch",Popup_OkToChangeIssueID:"popup_OkToChangeIssue",Popup_BookmarkInFirefoxNoteID:"popup_BookmarkInFirefoxNote",Popup_BookmarkInIE8NoteID:"popup_BookmarkInIE8Note",Popup_CopyLinkToClipboard:"popup_CopyLinkToClipboard",Popup_CopyLinkToClipboard_Text:"Popup_CopyLinkToClipboard_Text",Popup_LibraryID:"popup_Library",LibraryThumbnailListID:"LibraryThumbnailList",MainPageSwitcherID:"mainPageSwitcher",ContentsTitleID:"contentsTitle",ContentsMainTabStripID:"contentsMainTabStrip",ContentsMainPageSwitcherID:"contentsMainPageSwitcher",CtrlAllContentsID:"ctrlAllContents",PageItemContentsID:"pageItemContents",PaneListContentsID:"paneNavigate",PaneViewerFramesID:"paneViewerFrames",ContentsPublicationNameID:"contentsPublicationName",CtrlContentsPaneID:"ctrlContentsPane",splashscreenID:"splashscreen",BorderLeftTable:"BorderLeftTable",BorderRightTable:"BorderRightTable",PopupWindow_SelectPageToPrintID:"PopupWindow_SelectPageToPrint"};MainPage.Commands={OK_ChangeIssue:"OK_ChangeIssue",Cancel_ChangeIssue:"Cancel_ChangeIssue",OK_BookmarkInFirefoxNote:"OK_BookmarkInFirefoxNote",OK_BookmarkInIE8Note:"OK_BookmarkInIE8Note",ChangeDoublePageMode:"ChangeDoublePageMode",PrintDocument:"PrintDocument",CopyLink:"CopyLink",AddToFavorites:"AddToFavorites",SendMail:"SendMail",AddMailAlert:"AddMailAlert",ShowMyArticles:"ShowMyArticles",MoreIssues:"MoreIssues",ShowICViewer:"ShowICViewer",PDFDocDownload:"PDFDocDownload",PDFPageDownload:"PDFPageDownload",SaveForOffline:"SaveForOfflinePage",DoFacebook:"DoFacebook",DoTwitter:"DoTwitter",DoBookmarkDigg:"DoBookmarkDigg",DoBookmarkDelicious:"DoBookmarkDelicious",HideContentPane:"HideContentPane",OpenOliveSoftwareWebsite:"OpenOliveSoftwareWebsite",CloseCopyLinkToClipboardPopup:"CloseCopyLinkToClipboardPopup",PrintPageArea:"PrintPageArea",PrintPageArea_LeftPage:"PrintPageArea_LeftPage",PrintPageArea_RightPage:"PrintPageArea_RightPage"};MainPage.ResourceStrings={PopupInfo_Firefox_Bookmarks_Title:"PopupInfo_Firefox_Bookmarks_Title",PopupInfo_Firefox_Bookmarks_Introduction:"PopupInfo_Firefox_Bookmarks_Introduction",PopupInfo_Firefox_Bookmarks_Info:"PopupInfo_Firefox_Bookmarks_Info",PopupInfo_Firefox_Bookmarks_HowTo1:"PopupInfo_Firefox_Bookmarks_HowTo1",PopupInfo_Firefox_Bookmarks_HowTo1_WORD_Bookmarks:"PopupInfo_Firefox_Bookmarks_HowTo1_WORD_Bookmarks",PopupInfo_Firefox_Bookmarks_HowTo1_WORD_menu:"PopupInfo_Firefox_Bookmarks_HowTo1_WORD_menu",PopupInfo_Firefox_Bookmarks_HowTo1_WORD_right_click:"PopupInfo_Firefox_Bookmarks_HowTo1_WORD_right_click",PopupInfo_Firefox_Bookmarks_HowTo1_WORDS:"PopupInfo_Firefox_Bookmarks_HowTo1_WORDS",PopupInfo_Firefox_Bookmarks_HowTo1_WORD_Properties:"PopupInfo_Firefox_Bookmarks_HowTo1_WORD_Properties",PopupInfo_Firefox_Bookmarks_HowTo2:"PopupInfo_Firefox_Bookmarks_HowTo2",PopupInfo_Firefox_Bookmarks_HowTo2_WORDS:"PopupInfo_Firefox_Bookmarks_HowTo2_WORDS",PopupInfo_Firefox_Bookmarks_HowTo3:"PopupInfo_Firefox_Bookmarks_HowTo3",PopupInfo_Firefox_Bookmarks_WORD_OK:"PopupInfo_Firefox_Bookmarks_WORD_OK",PopupInfo_Firefox_Bookmarks_Checkbox:"PopupInfo_Firefox_Bookmarks_Checkbox",PopupInfo_IE8_Bookmarks_Title:"PopupInfo_IE8_Bookmarks_Title",PopupInfo_IE8_Bookmarks_Info:"PopupInfo_IE8_Bookmarks_Info",PopupInfo_IE8_Bookmarks_Info1:"PopupInfo_IE8_Bookmarks_Info1",PopupInfo_CopyLinkToClipboard_Title:"PopupInfo_CopyLinkToClipboard_Title",SearchPane_Empty:"SearchPane_Empty",TabItem_Contents:"TabItem_Contents",TabItem_Search:"TabItem_Search",Command_Library:"Command_Library",MenuItem_GoToFirstPage:"MenuItem_GoToFirstPage",MenuItem_GoToPreviousPage:"MenuItem_GoToPreviousPage",MenuItem_GoToPage:"MenuItem_GoToPage",MenuItem_GoToNextPage:"MenuItem_GoToNextPage",MenuItem_GoToLastPage:"MenuItem_GoToLastPage",MenuItem_ZoomOut:"MenuItem_ZoomOut",MenuItem_ZoomIn:"MenuItem_ZoomIn",MenuItem_EMailImage:"MenuItem_EMailImage",MenuItem_PrintImage:"MenuItem_PrintImage",MenuItem_SaveImage:"MenuItem_SaveImage",MenuItem_SaveArrow:"MenuItem_SaveArrow",MenuItem_DownloadPDF:"MenuItem_DownloadPDF",MenuItem_DownloadPagePDF:"MenuItem_DownloadPagePDF",MenuItem_Offline:"MenuItem_Offline",MenuItem_Bookmark:"MenuItem_Bookmark",MenuItem_ShareImage:"MenuItem_ShareImage",MenuItem_ShareArrow:"MenuItem_ShareArrow",MenuItem_Facebook:"MenuItem_Facebook",MenuItem_Twitter:"MenuItem_Twitter",MenuItem_Digg:"MenuItem_Digg",MenuItem_PostToDel:"MenuItem_PostToDel",MenuItem_AddMailAlert:"MenuItem_AddMailAlert",MenuItem_ShowMyArticles:"MenuItem_ShowMyArticles",MenuItem_CopyToClipBoard:"MenuItem_CopyToClipBoard",MenuItem_MinimizeToolbar:"MenuItem_MinimizeToolbar",MenuItem_MinimizeToolbarParent:"MenuItem_MinimizeToolbarParent",MenuItem_OliveSoftwareWebsite:"MenuItem_OliveSoftwareWebsite",Command_MaximizeToolbar:"Command_MaximizeToolbar",Command_MaximizeToolbarParent:"Command_MaximizeToolbarParent",FlashPane_NoDocument:"FlashPane_NoDocument",TabItem_Cover:"TabItem_Cover",TabItem_TableOfContents:"TabItem_TableOfContents",TabItem_Help:"TabItem_Help",Button_Close:"Button_Close",Button_Close_Image:"Button_Close_Image",Popup_Copyright_Warning_Content:"Popup_Copyright_Warning_Content",MenuItem_SinglewMode:"MenuItem_SinglewMode",MenuItem_DoubleMode:"MenuItem_DoubleMode",MenuItem_FitToWindow:"MenuItem_FitToWindow",MenuItem_FitToWidth:"MenuItem_FitToWidth"};MainPage.ErrorCodes={DocViewerAggAbsence:12001,FlashViewerAbsence:12002};MainPage.IFrames={ContentsPane:"ContentsPane.htm",SearchPane:"SearchPane.aspx",HelpIFrame:"Help/Help.htm"};MainPage.TabTitles={cover:"cover",toc:"toc",help:"help"};MainPage.TabIndexes={cover:0,toc:1,help:2};MainPage.DeclareType=function MainPage_DeclareType()
{this.DeclareField("m_oPopupWindow_ChangeIssue",null);this.DeclareField("m_oContentItem_ChangeIssue",null);this.DeclareField("m_controlDoNotAskAgain_ChangeIssue",null);this.DeclareField("m_oPopupWindow_BookmarkInFirefoxNote",null);this.DeclareField("m_oPopupWindow_BookmarkInIE8Note",null);this.DeclareField("m_CopyLinkToClipBoardPopup",null);this.DeclareField("m_controlDoNotAskAgain_BookmarkInFirefoxNote",null);this.DeclareField("m_oPopupWindow_Library",null);this.DeclareField("m_oPublicationList",null);this.DeclareField("m_oYearList",null);this.DeclareField("m_oLibraryThumbList",null);this.DeclareField("m_oMainPageSwitcher",null);this.DeclareField("m_oMainTabStrip",null);this.DeclareField("m_oContentsMainTabs",null);this.DeclareField("m_oPageItemCover",null);this.DeclareField("m_oPageItemHelp",null);this.DeclareField("m_oPageItemSearch",null);this.DeclareField("m_oBorderLeftTable",null);this.DeclareField("m_oBorderRightTable",null);this.DeclareField("m_oSearchPage",null);this.DeclareField("m_oContentPage",null);this.DeclareField("m_docViewerAgg",null);this.DeclareField("m_flashViewer",null);this.DeclareField("m_docViewerBar",null);this.DeclareField("m_oContentsTitle",null);this.DeclareField("m_oPaneListContents",null);this.DeclareField("m_oPaneViewerFramesRoot",null);this.DeclareField("m_oContentsPublicationName",null);this.DeclareField("m_oBanners",{});this.DeclareField("m_bSideBannersExist",false);this.DeclareField("m_sDisplayStyle","block");this.OverrideMethod("preInitialize",MainPage_preInitialize);this.OverrideMethod("postInitialize",MainPage_postInitialize);this.DeclareMethod("OpenDocument",MainPage_OpenDocument);this.DeclareMethod("OpenComponent",MainPage_OpenComponent);this.DeclareMethod("OpenCopyrightWindow",MainPage_OpenCopyrightWindow);this.DeclareMethod("SendMail",MainPage_SendMail);this.DeclareMethod("OpenOkToChangeIssueDialog",MainPage_OpenOkToChangeIssueDialog);this.DeclareMethod("changeIssue_Cancel",MainPage_changeIssue_Cancel);this.DeclareMethod("changeIssue_OK",MainPage_changeIssue_OK);this.DeclareMethod("OpenBookmarkInFirefoxDialog",MainPage_OpenBookmarkInFirefoxDialog);this.DeclareMethod("OpenBookmarkInIE8Dialog",MainPage_OpenBookmarkInIE8Dialog);this.DeclareMethod("bookmarkInFirefoxNote_OK",MainPage_bookmarkInFirefoxNote_OK);this.DeclareMethod("bookmarkInIE8Note_OK",MainPage_bookmarkInIE8Note_OK);this.DeclareMethod("openCopyToClipboardPopup",MainPage_openCopyToClipboardPopup);this.DeclareMethod("closeCopyLinkToClipboardPopup",MainPage_closeCopyLinkToClipboardPopup);this.DeclareMethod("openAccessNotificationDialog",MainPage_openAccessNotificationDialog);this.DeclareMethod("_closeAndSetCookie",MainPage_closeAndSetCookie);this.DeclareMethod("bindContentPage",MainPage_bindContentPage);this.DeclareMethod("bindSearchPage",MainPage_bindSearchPage);this.DeclareMethod("onEntityClicked",null);this.DeclareMethod("onEntityDoubleClicked",MainPage_openEntityInICViewer);this.DeclareMethod("onDocumentLoaded",MainPage_onDocumentLoaded);this.DeclareMethod("onStateChanged",MainPage_onPageItemActivated);this.DeclareMethod("onPageTurned",MainPage_refreshBanners);this.DeclareMethod("onGatefoldStatusChanged",MainPage_refreshBanners);this.DeclareMethod("onFullScreenChanged",MainPage_onFullScreenChanged);this.DeclareMethod("onFitZoomChanged",MainPage_onFitZoomChanged);this.DeclareMethod("onGlobalDoublePageModeChanged",MainPage_onGlobalDoublePageModeChanged);this.DeclareMethod("onRichMediaCommand",MainPage_onRichMediaCommand);this.DeclareMethod("_onChangeDoublePageMode",MainPage_onChangeDoublePageMode);this.DeclareMethod("_updateDoublePageMode",MainPage_updateDoublePageMode);this.DeclareMethod("_onPrintDocument",MainPage_onPrintDocument);this.DeclareMethod("_PrintDocumentPages",MainPage_PrintDocumentPages);this.DeclareMethod("_onSendMail",MainPage_onSendMail);this.DeclareMethod("_onAddMailAlert",MainPage_onAddMailAlert);this.DeclareMethod("_onShowMyArticles",MainPage_onShowMyArticles);this.DeclareMethod("_onCopyLink",MainPage_onCopyLink);this.DeclareMethod("_onAddToFavorites",MainPage_onAddToFavorites);this.DeclareMethod("_onDoBookmark",MainPage_onDoBookmark);this.DeclareMethod("_onMoreIssues",MainPage_onMoreIssues);this.DeclareMethod("_onThumbListSelectionChanged",MainPage_onThumbListSelectionChanged);this.DeclareMethod("_onPDFDocDownload",MainPage_onPDFDocDownload);this.DeclareMethod("_onPDFPageDownload",MainPage_onPDFPageDownload);this.DeclareMethod("_onSaveForOffline",MainPage_onSaveForOffline);this.DeclareMethod("_onNavigationPaneVisibilityChanged",MainPage_onNavigationPaneVisibilityChanged);this.DeclareMethod("_updatePDFPageState",MainPage_updatePDFPageState);this.DeclareMethod("_updatePDFDocumentState",MainPage_updatePDFDocumentState);this.DeclareMethod("_updateAddToFavoritesState",MainPage_updateAddToFavoritesState);this.DeclareMethod("_updateSaveForOfflineState",MainPage__updateSaveForOfflineState);this.DeclareMethod("_updateSendPageEmailState",MainPage_updateSendPageEmailState);this.DeclareMethod("_updatePrintPageState",MainPage_updatePrintPageState);this.DeclareMethod("_updateExternalBookmarkingDiggState",MainPage_updateExternalBookmarkingDiggState);this.DeclareMethod("_updateExternalBookmarkingDeliciousState",MainPage_updateExternalBookmarkingDeliciousState);this.DeclareMethod("_updateCopyToClipboardPageState",MainPage_updateCopyToClipboardPageState);this.DeclareMethod("_updateEmailAlertsState",MainPage_updateEmailAlertsState);this.DeclareMethod("_updateShowMyArticlesState",MainPage_updateShowMyArticlesState);this.DeclareMethod("_onContentsPaneResized",MainPage_onContentsPaneResized);this.DeclareMethod("_onPaneListRootResized",MainPage_onPaneListRootResized);this.DeclareMethod("_HideContentPane",MainPage_HideContentPane);this.DeclareMethod("_OpenOliveSoftwareWebsite",MainPage_OpenOliveSoftwareWebsite);this.DeclareMethod("_BannersVisibilityChanged",MainPage_BannersVisibilityChanged);this.OverrideMethod("_getContentItem",MainPage_getContentItem);this.DeclareMethod("_findControls",MainPage_findControls);this.DeclareMethod("_followPageLink",MainPage_followPageLink);this.DeclareMethod("_updateIFrame",MainPage_updateIFrame);this.DeclareMethod("_importScripts",MainPage_importScripts);this.DeclareMethod("_clearThumbnails",MainPage_clearThumbnails);this.DeclareMethod("_bindTabs",MainPage_bindTabs);this.DeclareMethod("_setFitMode",MainPage_setFitMode);this.DeclareMethod("_refreshIFrame",MainPage_refreshIFrame);this.DeclareMethod("_doRefreshBanners",MainPage_doRefreshBanners);this.DeclareMethod("_initBanner",MainPage_initBanner);this.DeclareMethod("_checkDimension",MainPage_checkDimension);this.DeclareMethod("get_SearchPage",MainPage_get_SearchPage);this.DeclareMethod("get_ContentPage",MainPage_get_ContentPage);this.DeclareMethod("_onPrintPageArea",MainPage_onPrintPageArea);this.DeclareMethod("_onPrintPageArea_LeftPage",MainPage_onPrintPageArea_LeftPage);this.DeclareMethod("_onPrintPageArea_RightPage",MainPage_onPrintPageArea_RightPage);}
MainPage.ApplyPrototype=function MainPage_ApplyPrototype(classProto)
{Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.OK_ChangeIssue,"changeIssue_OK");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.Cancel_ChangeIssue,"changeIssue_Cancel");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.OK_BookmarkInFirefoxNote,"bookmarkInFirefoxNote_OK");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.OK_BookmarkInIE8Note,"bookmarkInIE8Note_OK");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.ChangeDoublePageMode,"_onChangeDoublePageMode","_updateDoublePageMode");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.PrintDocument,"_onPrintDocument","_updatePrintPageState");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.SendMail,"_onSendMail","_updateSendPageEmailState");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.CopyLink,"_onCopyLink","_updateCopyToClipboardPageState");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.AddToFavorites,"_onAddToFavorites","_updateAddToFavoritesState");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.DoFacebook,"_onDoBookmark");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.DoTwitter,"_onDoBookmark");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.DoBookmarkDigg,"_onDoBookmark","_updateExternalBookmarkingDiggState");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.DoBookmarkDelicious,"_onDoBookmark","_updateExternalBookmarkingDeliciousState");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.MoreIssues,"_onMoreIssues");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.AddMailAlert,"_onAddMailAlert","_updateEmailAlertsState");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.ShowMyArticles,"_onShowMyArticles","_updateShowMyArticlesState");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.PDFDocDownload,"_onPDFDocDownload","_updatePDFDocumentState");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.PDFPageDownload,"_onPDFPageDownload","_updatePDFPageState");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.SaveForOffline,"_onSaveForOffline","_updateSaveForOfflineState");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.HideContentPane,"_HideContentPane");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.OpenOliveSoftwareWebsite,"_OpenOliveSoftwareWebsite");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.CloseCopyLinkToClipboardPopup,"closeCopyLinkToClipboardPopup");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.PrintPageArea,"_onPrintPageArea","_updatePrintPageState");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.PrintPageArea_LeftPage,"_onPrintPageArea_LeftPage");Olive.CmdTarget.RegisterCommand(classProto,MainPage.Commands.PrintPageArea_RightPage,"_onPrintPageArea_RightPage");};function MainPage_preInitialize(popupArguments)
{var oPaneViewerFramesRoot=document.getElementById(MainPage.ElementIDs.PaneViewerFramesID);var nFrameRootsHeight=DHTML.getElemHeight(oPaneViewerFramesRoot);var oTopBannerIds={sPaneId:MainPage.ElementIDs.TopAdPaneID,sPrefHeight:"top-banner-height",sPrefWidth:"top-banner-width",sPrefRefresh:"refresh-top-banner-on-flip",sIFrameId:MainPage.ElementIDs.TopAdIFrameID};this.m_oBanners.Top=this._initBanner(oTopBannerIds,true);var oLeftBannerIds={sPaneId:MainPage.ElementIDs.LeftAdPaneID,sPrefHeight:"left-banner-height",sPrefWidth:"left-banner-width",sPrefRefresh:"refresh-left-banner-on-flip",sIFrameId:MainPage.ElementIDs.LeftAdIFrameID};this.m_oBanners.Left=this._initBanner(oLeftBannerIds,false,nFrameRootsHeight);var oRightBannerIds={sPaneId:MainPage.ElementIDs.RightAdPaneID,sPrefHeight:"right-banner-height",sPrefWidth:"right-banner-width",sPrefRefresh:"refresh-right-banner-on-flip",sIFrameId:MainPage.ElementIDs.RightAdIFrameID};this.m_oBanners.Right=this._initBanner(oRightBannerIds,false,nFrameRootsHeight);var rightBannerHeight=parseInt(this.m_oBanners.Right.nHeight,10);var leftBannerHeight=parseInt(this.m_oBanners.Left.nHeight,10);if(leftBannerHeight>0||rightBannerHeight>0)
{this.m_bSideBannersExist=true;if(isMozilla()||isSafari())
{this.m_sDisplayStyle="table-cell";}}}
function MainPage_checkDimension(dimension)
{var tmpDim=parseInt(dimension,10);if(tmpDim==0)
return false;if(!isNaN(dimension))
return true;dimension=dimension.toString().toLowerCase();if(dimension.indexOf("%")!=-1)
return true;if(dimension.indexOf("px")!=-1)
return true;return false;}
function MainPage_initBanner(oBannerIds,bInitialVisible,nFrameRootsHeight)
{var oBanner={oPane:null,nHeight:0,nWidth:0,bRefresh:true,oIFrame:null};var oBannerPane=document.getElementById(oBannerIds.sPaneId);if(oBannerPane)
{oBanner.oPane=oBannerPane;oBanner.nHeight=this.WebApplication.getPreference(oBannerIds.sPrefHeight);oBanner.nWidth=this.WebApplication.getPreference(oBannerIds.sPrefWidth);if(!isNaN(oBanner.nHeight)&&oBanner.nHeight>0)
oBanner.nHeight+="px";if(!isNaN(oBanner.nWidth)&&oBanner.nWidth>0)
oBanner.nWidth+="px";var nHeight=oBanner.nHeight;if(this._checkDimension(oBanner.nHeight)&&this._checkDimension(oBanner.nWidth))
{if(oBannerIds.sPaneId!=MainPage.ElementIDs.TopAdPaneID)
{nHeight=Math.min(nHeight,nFrameRootsHeight);}
oBanner.bRefresh=this.WebApplication.getPreferenceBoolean(oBannerIds.sPrefRefresh,true);oBanner.oPane.style.height=oBanner.nHeight;oBanner.oPane.style.width=oBanner.nWidth;oBanner.oIFrame=document.getElementById(oBannerIds.sIFrameId);if(oBanner.oIFrame)
{oBanner.oIFrame.style.height=oBanner.nHeight;oBanner.oIFrame.style.width=oBanner.nWidth;}
if(!bInitialVisible)
{oBanner.oPane.style.display="none";}}
else
{oBanner.oPane.style.display="none";}}
return oBanner;}
function MainPage_postInitialize(popupArguments)
{DHTML.setCookie("first_launch","false");var oSplashScreen=document.getElementById(MainPage.ElementIDs.splashscreenID);if(oSplashScreen)
{var oSplashParent=oSplashScreen.parentNode;if(oSplashParent)
{oSplashParent.removeChild(oSplashScreen);}}
this._findControls();this.m_oPaneListContents.attachOwcEventHandler("panesResized",this._onContentsPaneResized,this);this.m_oPaneViewerFramesRoot.attachOwcEventHandler("panesResized",this._onPaneListRootResized,this);var sSplitterPosition_Cookie=DHTML.getCookie(this.WebApplication.sSplitterPosition_Cookie);if(sSplitterPosition_Cookie)
{this.m_oPaneViewerFramesRoot.setSplitterPaneProportion(sSplitterPosition_Cookie);}
this.m_oPageItemHelp.attachOwcEventHandler("stateChanged",this._updateIFrame,this);this.m_oPageItemSearch.attachOwcEventHandler("stateChanged",this._updateIFrame,this);this._bindTabs();this.m_docViewerAgg.attachOwcEventHandler("navigationPaneVisibilityChanged",this._onNavigationPaneVisibilityChanged,this);this.m_flashViewer.attachOwcEventHandler("flipAreaOrPageButtonClicked",this._onflipAreaOrPageButtonClicked,this);for(var res_str in MainPage.ResourceStrings)
this.WebApplication.setResString(window.document,res_str);this.bindContentPage();this.bindSearchPage();this.m_bInitialized=true;this.WebApplication.onMainPageLoaded();Olive.EventSource.RegisterEventHandler("","closeSearchPane",false,this._HideContentPane,this);if(this.WebApplication.getPreferenceBoolean("activate-ic-on-single-click",false))
{JScript.Type.DeclareMethod(this,"onEntityClicked",MainPage_openEntityInICViewer);}
var nThumbListSize=this.WebApplication.getPreference("more-issues-page-size",12);if(this.m_oPopupWindow_Library)
{if(this.m_oLibraryThumbList)
{this.m_oLibraryThumbList.m_nPageSize=nThumbListSize;}}
if(this.WebApplication.getPreferenceBoolean("hide-content-pane",false))
this._HideContentPane();}
function MainPage_OpenDocument(contentItem,bCreateCopy,bUpdateThumbnails,bCheckIfActive,bClearSearchRes,bDoNotResetTabs)
{if(!contentItem)
return;var oContentItem=null;if(bCreateCopy||contentItem.m_sContentSrc==OwcContentSrc_Link)
{var oDocumentViewSource=Olive.ContentItem.CreateByType(OwcContentItem_Document);oDocumentViewSource.copyDocRefFrom(contentItem);if(contentItem.m_nPageNo)
oDocumentViewSource.m_nPageNo=contentItem.m_nPageNo;oContentItem=oDocumentViewSource;}
else
{oContentItem=Olive.ContentItem.Clone(contentItem);}
this.WebApplication.m_documentViewSource=oContentItem;if(this.WebApplication.m_bUseZoomFromSearchResults&&contentItem.DataObjectType==OwcContentItem_SearchResult)
{var oNavigateToHitParams=this.m_docViewerAgg.m_oViewerCtrl.getNavigateToHitParams(contentItem);this.m_docViewerAgg.navigateToHit(oNavigateToHitParams.sDocHRef,oNavigateToHitParams.sEntityId,oNavigateToHitParams.nEntityPageNo,oNavigateToHitParams.nFirstHitPageNo,oNavigateToHitParams.sHitBoxCenter,this.WebApplication.m_bHighlightPrimitiveOnSearchResult,this.WebApplication.m_sZoomFromSearchResults);if(oNavigateToHitParams.nFirstHitPageNo>0)
{var oSearchQueryContentItem=contentItem.getParentItemByType(OwcContentItem_SearchQuery);if(oSearchQueryContentItem)
{var bLoadHitsForDocument="auto";var sSearchQuery=oSearchQueryContentItem.m_oSearchParams.toString();this.m_docViewerAgg.m_oViewerCtrl.loadSearchHits(oNavigateToHitParams.nFirstHitPageNo,null,sSearchQuery,bLoadHitsForDocument,oNavigateToHitParams.sEntityId,null,oNavigateToHitParams.sDocHRef,true);}}}
else
this.m_docViewerAgg.contentLoadItem(oContentItem);this.m_docViewerAgg.m_oTOCCtrl.setLoadingDataMessage();if(bClearSearchRes&&this.m_docViewerAgg.m_oSearchResCtrl)
this.m_docViewerAgg.m_oSearchResCtrl.clearContent();if(bUpdateThumbnails)
this._clearThumbnails(oContentItem,bCheckIfActive);this.WebApplication.m_sDocHRef=oContentItem.getDocHRef();if(!bDoNotResetTabs&&!this.WebApplication.getPreferenceBoolean("save-tab-state-on-issue-switch"))
{this.m_oMainTabStrip.setActiveItem(0);this.m_oContentsMainTabs.setActiveItem(1);var contentPage=this.get_ContentPage();if(contentPage)
{contentPage.m_oContentsTabs.setActiveItem(0);}}}
function MainPage_clearThumbnails(oContentItem,bCheckIfActive)
{var contentPage=this.get_ContentPage();if(this.m_docViewerAgg.m_oPageThumbnailsCtrl)
{if(bCheckIfActive&&contentPage&&contentPage.m_thumbnailsPage.isStateSet(Olive.IState.State.Active))
{this.m_docViewerAgg.m_oPageThumbnailsCtrl.contentLoadItem(oContentItem);}
else
{this.m_docViewerAgg.m_oPageThumbnailsCtrl.clearContent();this.m_docViewerAgg.m_oPageThumbnailsCtrl.m_oContentItem=null;}}
if(this.m_docViewerAgg.m_oFeaturedPagesCtrl)
{if(bCheckIfActive&&contentPage&&contentPage.m_featuredPagesPage.isStateSet(Olive.IState.State.Active))
{this.m_docViewerAgg.m_oFeaturedPagesCtrl.contentLoadItem(oContentItem);}
else
{this.m_docViewerAgg.m_oFeaturedPagesCtrl.clearContent();this.m_docViewerAgg.m_oFeaturedPagesCtrl.m_oContentItem=null;}}}
function MainPage_bindContentPage()
{var contentPage=this.get_ContentPage();if(!contentPage||!contentPage.m_bInitialized)
return;contentPage.BindDocViewerParts(this.m_docViewerAgg,[this.m_oContentsPageItem,this.m_oAllContentsPageItem]);}
function MainPage_bindSearchPage()
{var searchPage=this.get_SearchPage()
if(!searchPage||!searchPage.m_bInitialized)
return;searchPage.BindDocViewerParts(this.m_docViewerAgg);var oEmptySearchPane=getObj(MainPage.ResourceStrings.SearchPane_Empty);if(oEmptySearchPane)
oEmptySearchPane.innerHTML="";}
function MainPage_OpenComponent(contentItem)
{var oWindowOptions=new Olive.Data.PopupWindowOptions();var nICPopupWindowMaxTitleLength=this.WebApplication.m_nICPopupWindowMaxTitleLength;if(oWindowOptions)
{oWindowOptions.setTitle(this.getResString("Popup_ICViewer_InitialTitle"));oWindowOptions.target="popup_componentViewer";oWindowOptions.setIsResizable(true);oWindowOptions.setMinimalWidth(265);oWindowOptions.setMinimalHeight(150);this.openPopup("ComponentViewerForm.htm",oWindowOptions,contentItem,null,true);}}
function MainPage_OpenCopyrightWindow()
{var oWindowOptions=new Olive.Data.PopupWindowOptions();oWindowOptions.setTitle(this.getResString("Popup_Copyright_Warning"));oWindowOptions.target="popup_copyrightWarning";oWindowOptions.setIsResizable(true);oWindowOptions.setWidth(510);oWindowOptions.setHeight(620);this.openPopup("",oWindowOptions,null,null,true);}
function MainPage_onThumbListSelectionChanged(eventArgs)
{var oSelectedContentItem=this.m_oLibraryThumbList.getSelectedContentItem();if(this.WebApplication.isDocHRefDifferent(oSelectedContentItem))
{var sDocHRef=oSelectedContentItem.getDocHRef();this.WebApplication.m_sDocHRef=sDocHRef;this.OpenDocument(oSelectedContentItem,true,true,true,true,false);}
if(this.m_oPopupWindow_Library)
this.m_oPopupWindow_Library.close();}
function MainPage_SendMail(mailParams,bIsEntity,oOpenerPage)
{if(!mailParams)
return;var oWindowOptions=new Olive.Data.PopupWindowOptions();oWindowOptions.target="popup_mailForm";oWindowOptions.setIsResizable(false);oWindowOptions.setHeight(380);oWindowOptions.setWidth(360);var sPopupTitle="";if(bIsEntity)
{var sEntityType=this.WebApplication.getEntityType(mailParams.oSrcContentItem.m_sEntityId);switch(sEntityType.toLowerCase())
{case Olive.ContentItem.Entity.EntityTypes.article:sPopupTitle=this.getResString("Popup_Email_Article");break;case Olive.ContentItem.Entity.EntityTypes.ad:sPopupTitle=this.getResString("Popup_Email_Ad");break;case Olive.ContentItem.Entity.EntityTypes.picture:sPopupTitle=this.getResString("Popup_Email_Picture");break;default:break;}}
else
{sPopupTitle=this.getResString("Popup_Email_Page");}
oWindowOptions.setTitle(sPopupTitle);if(!oOpenerPage)
{oOpenerPage=this;}
oOpenerPage.openPopup("SendMailForm.htm",oWindowOptions,mailParams,null,true);}
function MainPage_closeAndSetCookie(oPopupWindow,bSetCookie,sCookieName)
{if(oPopupWindow)
oPopupWindow.close();if(bSetCookie)
DHTML.setCookie(sCookieName,"true");}
function MainPage_OpenOkToChangeIssueDialog(oPopupArgs)
{var oWindowOptions=new Olive.Data.PopupWindowOptions();oWindowOptions.target=MainPage.ElementIDs.Popup_OkToChangeIssueID;oWindowOptions.setIsResizable(false);oWindowOptions.setHeight(180);oWindowOptions.setWidth(405);oWindowOptions.setTitle("Do you want to view a different issue?");if(oPopupArgs)
{this.m_oContentItem_ChangeIssue=oPopupArgs.oContentItem;var oPriorPublication=OwcGetControl("priorpublication");var oNewPublication=OwcGetControl("newpublication");var sPriorPublication=this.WebApplication.getPublicationDescription();var sNewPublication=oPopupArgs.oContentItem.getPublicationDescription();if(sPriorPublication&&sNewPublication&&sPriorPublication!=sNewPublication)
{oPriorPublication.setValue(sPriorPublication+", ");oNewPublication.setValue(sNewPublication+", ");}
else
{oPriorPublication.setValue("");oNewPublication.setValue("");}
var oPriorDate=OwcGetControl("priordate");var oNewDate=OwcGetControl("newdate");var sPriorDate=oPopupArgs.sPriorDocHRef.substring(oPopupArgs.sPriorDocHRef.indexOf("/")+1);var sNewDate=oPopupArgs.sNewDocHRef.substring(oPopupArgs.sNewDocHRef.indexOf("/")+1);if(sPriorDate)
oPriorDate.setValue(sPriorDate);if(sNewDate)
oNewDate.setValue(sNewDate);}
this.m_controlDoNotAskAgain_ChangeIssue=OwcGetControl("bDoNotAskAgain_ChangeIssue");this.m_controlDoNotAskAgain_ChangeIssue.setValue(false);this.openPopup("",oWindowOptions,oPopupArgs,null,true);}
function MainPage_changeIssue_Cancel()
{var bDoNotAskAgain=this.m_controlDoNotAskAgain_ChangeIssue.getValue();this._closeAndSetCookie(this.m_oPopupWindow_ChangeIssue,bDoNotAskAgain,this.WebApplication.m_sOpenNewIssue_Cookie);}
function MainPage_changeIssue_OK()
{var bDoNotAskAgain=this.m_controlDoNotAskAgain_ChangeIssue.getValue();this._closeAndSetCookie(this.m_oPopupWindow_ChangeIssue,bDoNotAskAgain,this.WebApplication.m_sOpenNewIssue_Cookie);this.WebApplication._openDifferentDocument(this.m_oContentItem_ChangeIssue,true);}
function MainPage_OpenBookmarkInFirefoxDialog(docViewerAgg)
{var sValue=DHTML.getCookie(this.WebApplication.m_sSaveBookmarkInFireFox_Cookie);if(sValue!="true")
{var oWindowOptions=new Olive.Data.PopupWindowOptions();oWindowOptions.target=MainPage.ElementIDs.Popup_BookmarkInFirefoxNoteID;oWindowOptions.setIsResizable(false);oWindowOptions.setHeight(240);oWindowOptions.setWidth(500);oWindowOptions.setTitle(this.getResString("PopupInfo_Firefox_Bookmarks_Title"));this.m_controlDoNotAskAgain_BookmarkInFirefoxNote=OwcGetControl("bDoNotAskAgain_BookmarkInFirefoxNote");this.m_controlDoNotAskAgain_BookmarkInFirefoxNote.setValue(false);this.openPopup("",oWindowOptions,docViewerAgg,null,true);}}
function MainPage_OpenBookmarkInIE8Dialog(docViewerAgg,addToFavoritesLink,docTitle)
{var oWindowOptions=new Olive.Data.PopupWindowOptions();oWindowOptions.target=MainPage.ElementIDs.Popup_BookmarkInIE8NoteID;oWindowOptions.setIsResizable(false);oWindowOptions.setHeight(240);oWindowOptions.setWidth(450);oWindowOptions.setTitle(this.getResString("PopupInfo_IE8_Bookmarks_Title"));this.addToFavoritesLinkUrl=addToFavoritesLink;this.addToFavoritesLinkTitle=docTitle;this.openPopup("",oWindowOptions,docViewerAgg,null,true);}
function MainPage_bookmarkInFirefoxNote_OK()
{var bDoNotAskAgain=this.m_controlDoNotAskAgain_BookmarkInFirefoxNote.getValue();this._closeAndSetCookie(this.m_oPopupWindow_BookmarkInFirefoxNote,bDoNotAskAgain,this.WebApplication.m_sSaveBookmarkInFireFox_Cookie);}
function MainPage_bookmarkInIE8Note_OK()
{window.external.AddFavorite(this.addToFavoritesLinkUrl,this.addToFavoritesLinkTitle);this.m_oPopupWindow_BookmarkInIE8Note.close();}
function MainPage_findControls()
{this.m_docViewerAgg=this.findControlByType(Olive.Controls.controlTypeNames.DocViewerAgg);if(!this.m_docViewerAgg)
{this.reportError(DHTML.newError(MainPage.ErrorCodes.DocViewerAggAbsence,"Internal error: Cannot find Olive.Controls.DocViewerAgg control on HTML page"));return;}
this.m_flashViewer=this.m_docViewerAgg.m_oViewerCtrl;if(!this.m_flashViewer)
{this.reportError(DHTML.newError(MainPage.ErrorCodes.FlashViewerAbsence,"Internal error: Cannot find Olive.Controls.FlashViewer control on HTML page"));return;}
this.m_docViewerBar=OwcGetControl(MainPage.ElementIDs.DocumentToolbarId);this.m_oContentsTitle=OwcGetControl(MainPage.ElementIDs.ContentsTitleID);this.m_oContentsPublicationName=OwcGetControl(MainPage.ElementIDs.ContentsPublicationNameID);this.m_oAllContentsPageItem=OwcGetControl(MainPage.ElementIDs.CtrlAllContentsID);this.m_oContentsPageItem=OwcGetControl(MainPage.ElementIDs.PageItemContentsID);this.m_oPaneListContents=OwcGetControl(MainPage.ElementIDs.PaneListContentsID);this.m_oPaneViewerFramesRoot=OwcGetControl(MainPage.ElementIDs.PaneViewerFramesID);this.m_oPopupWindow_ChangeIssue=OwcGetControl(MainPage.ElementIDs.Popup_OkToChangeIssueID);this.m_oPopupWindow_BookmarkInFirefoxNote=OwcGetControl(MainPage.ElementIDs.Popup_BookmarkInFirefoxNoteID);this.m_oPopupWindow_BookmarkInIE8Note=OwcGetControl(MainPage.ElementIDs.Popup_BookmarkInIE8NoteID);this.m_CopyLinkToClipBoardPopup=OwcGetControl(MainPage.ElementIDs.Popup_CopyLinkToClipboard);this.m_oPopupWindow_Library=OwcGetControl(MainPage.ElementIDs.Popup_LibraryID);this.m_oLibraryThumbList=OwcGetControl(MainPage.ElementIDs.LibraryThumbnailListID);this.m_oPageItemCover=OwcGetControl(MainPage.ElementIDs.PageItemCoverID);this.m_oPageItemHelp=OwcGetControl(MainPage.ElementIDs.PageItemHelpID);this.m_oPageItemSearch=OwcGetControl(MainPage.ElementIDs.PageItemSearchID);this.m_oBorderLeftTable=document.getElementById(MainPage.ElementIDs.BorderLeftTable);this.m_oBorderRightTable=document.getElementById(MainPage.ElementIDs.BorderRightTable);this.m_oPopupWindow_SelectPageToPrint=OwcGetControl(MainPage.ElementIDs.PopupWindow_SelectPageToPrintID);}
function MainPage_bindTabs()
{this.m_oMainPageSwitcher=OwcGetControl(MainPage.ElementIDs.MainPageSwitcherID);if(this.m_oMainPageSwitcher)
{this.m_oMainTabStrip=OwcGetControl(MainPage.ElementIDs.MainTabStripID);if(this.m_oMainTabStrip&&this.m_docViewerAgg)
{this.m_oMainTabStrip.attachOwcEventHandler("itemActivating",this.m_docViewerAgg._onTabActivating,this.m_docViewerAgg);Olive.Binding.SyncActiveItems.BindControls(this.m_oMainTabStrip,this.m_oMainPageSwitcher);}}
this.m_oContentsMainTabs=OwcGetControl(MainPage.ElementIDs.ContentsMainTabStripID);var oContentsMainPageSwitcher=OwcGetControl(MainPage.ElementIDs.ContentsMainPageSwitcherID);if(this.m_oContentsMainTabs&&oContentsMainPageSwitcher)
{Olive.Binding.SyncActiveItems.BindControls(this.m_oContentsMainTabs,oContentsMainPageSwitcher);var nInitialTab=MainPage.TabIndexes.cover;var sInitialTab=this.WebApplication.m_sInitialTab;switch(sInitialTab)
{case MainPage.TabTitles.cover:nInitialTab=MainPage.TabIndexes.cover;break;case MainPage.TabTitles.toc:nInitialTab=MainPage.TabIndexes.toc;break;case MainPage.TabTitles.help:nInitialTab=MainPage.TabIndexes.help;break;}
this.m_oContentsMainTabs.setActiveItem(nInitialTab);}}
function MainPage_get_ContentPage()
{if(!this.m_oContentPage)
{var frameElement=document.getElementById("contentsFrame");var frameDocument=DHTML_GetIFrameDocument(frameElement);this.m_oContentPage=Olive.Page.GetPageForDocument(frameDocument);}
return this.m_oContentPage;}
function MainPage_get_SearchPage()
{if(!this.m_oSearchPage)
{var frameElement=document.getElementById("searchFrame");var frameDocument=DHTML_GetIFrameDocument(frameElement);this.m_oSearchPage=Olive.Page.GetPageForDocument(frameDocument);}
return this.m_oSearchPage;}
function MainPage_onPageItemActivated(eventArgs)
{var oSrcObject=eventArgs.srcObject;if(!oSrcObject||oSrcObject.controlType!=Olive.Controls.controlTypeNames.PageItem)
return;var stateChanged=eventArgs.prevState^eventArgs.newState;if((stateChanged&Olive.IState.State.ActiveMask)!=0)
{var pageItemActivated=((eventArgs.newState&Olive.IState.State.ActiveMask)==Olive.IState.State.Active);if(!pageItemActivated)
return;if(this.m_oPaneListContents)
this.m_oPaneListContents.recalcLayout();if(isSafari())
{var contentPage=this.get_ContentPage();if(contentPage)
contentPage._onPageItemActivated();}}}
function MainPage_getContentItem()
{if(!this.m_docViewerAgg)
return null;var sourceContentItem=this.m_docViewerAgg.getContentItem();return sourceContentItem;}
function MainPage_openEntityInICViewer(eventArgs)
{if(eventArgs.bCopyrighted)
{this.OpenCopyrightWindow();}
else
{var oContentItem=new Olive.ContentItem.Entity();oContentItem.m_sDocHRef=eventArgs.sBaseHref;oContentItem.m_sEntityId=eventArgs.sEntityID;oContentItem.m_sPrimitiveId=eventArgs.sPrimitiveID;oContentItem.m_sPublicationDescription=eventArgs.srcObject.getContentItem().m_sPublicationDescription;oContentItem.expando=true;oContentItem.viewMode=this.WebApplication.m_sICViewMode;this.WebApplication.OpenComponent(oContentItem);}}
function MainPage_onRichMediaCommand(eventArgs)
{if(eventArgs.command=="play"){var oWindowOptions=new Olive.Data.PopupWindowOptions();oWindowOptions.target="popup_RichMedia";if(!!eventArgs.popupHeight)
oWindowOptions.setHeight(eventArgs.popupHeight);else
oWindowOptions.setHeight(450);if(!!eventArgs.popupWidth)
oWindowOptions.setWidth(eventArgs.popupWidth);else
oWindowOptions.setWidth(600);var url=eventArgs.url;if(eventArgs.mediaType!="html"){var queryString=new QueryString();queryString.addParam("mediaType",eventArgs.mediaType);queryString.addParam("src",eventArgs.url);queryString.addParam("id",eventArgs.id);url="MediaPlayer.aspx?"+queryString.getQueryString();}
var popupWindow=this.openPopup(url,oWindowOptions,null,null,true);if(!!popupWindow)
popupWindow.autoSize(oWindowOptions.getWidth(),oWindowOptions.getHeight());}
else if(eventArgs.command=="stop"){}}
function MainPage_onDocumentLoaded(eventArgs)
{this.m_docViewerAgg.m_oTOCCtrl.contentLoadItem(this.m_docViewerAgg.getContentItem(),true);var bDoublePageMode=this.WebApplication.m_bDoublePageMode;var sDoublePageMode=DHTML.getCookie(this.WebApplication.m_sDoublePageMode_Cookie);if(sDoublePageMode!=null)
bDoublePageMode=String_parseBoolean(sDoublePageMode);this.m_docViewerAgg.set_GlobalDoublePageMode(bDoublePageMode);if(this.m_docViewerAgg.getContentItem().DataObjectType==OwcContentItem_SearchResult)
{this.m_flashViewer.attachOwcEventHandler("SearchHitsLoaded",this._setFitMode,this);}
else
{this._setFitMode();}
var sDocHRef=eventArgs.sBaseHref;if(sDocHRef)
{this.WebApplication.m_sDocHRef=sDocHRef;this.WebApplication.setPublicationDescription(eventArgs.sPublicationDescription);var sDate=sDocHRef.substring(sDocHRef.indexOf("/")+1);var sFormat=this.WebApplication.m_sDateFormat;if(this.m_oContentsTitle)
{this.m_oContentsTitle.setFormat(sFormat);this.m_oContentsTitle.setValue(sDate);this.WebApplication.setContentsTitle(this.m_oContentsTitle.getValue());}}
if(this.m_oContentsPublicationName)
{this.m_oContentsPublicationName.setValue(eventArgs.sPublicationDescription+String.fromCharCode(160,160));}
var oContentItem=this._getContentItem();if(!oContentItem)
return;if(oContentItem.m_sEntityId&&this.WebApplication.m_bOpenICViewerOnDocumentLoad)
{oContentItem.expando=true;oContentItem.viewMode=this.WebApplication.m_sICViewMode;this.WebApplication.OpenComponent(oContentItem);}
else
{this.WebApplication.ClosePopups(false);}
if(oContentItem.m_sPrimId)
{if(this.m_flashViewer)
{var nPageNo=oContentItem.m_nPageNo;var sPrimId=oContentItem.m_sPrimId;var sEntityId=oContentItem.m_sEntityId;this.m_flashViewer.gotoPageWithHighlighting(nPageNo,sPrimId,sEntityId);}}
this.WebApplication.m_bOpenICViewerOnDocumentLoad=false;var searchPage=this.get_SearchPage()
if(searchPage)
searchPage._updateSearchIn();}
function MainPage_followPageLink(nPageNo)
{if(nPageNo>0&&this.m_flashViewer)
this.m_flashViewer.gotoPageWithHighlighting(nPageNo,"");}
function MainPage_onChangeDoublePageMode(commandParam)
{var bDoublePageMode=this.m_docViewerAgg.get_GlobalDoublePageMode();var bModeParam=String_parseBoolean(commandParam);if(bDoublePageMode!=bModeParam)
{this.m_docViewerAgg.set_GlobalDoublePageMode(bModeParam);DHTML.setCookie(this.WebApplication.m_sDoublePageMode_Cookie,bModeParam);this.m_flashViewer.cmdChangeModeDoublePage(bModeParam);var bIsNavPaneVisible=this.m_docViewerAgg.m_oNavigationPane.isVisible();if(bIsNavPaneVisible)
{this.m_docViewerAgg._HideNavigationPane();}}}
function MainPage_updateDoublePageMode(oCmdUiState)
{if(!this.m_flashViewer||!this.m_flashViewer.getDocumentLoaded())
{oCmdUiState.enableCommand(false);return false;}
var bDoublePageMode=this.m_docViewerAgg.get_GlobalDoublePageMode();switch(oCmdUiState.commandParams)
{case"false":oCmdUiState.checkCommand(!bDoublePageMode);break;case"true":oCmdUiState.checkCommand(bDoublePageMode);break;}
oCmdUiState.enableCommand(true);return true;}
function MainPage_onGlobalDoublePageModeChanged(oEvent)
{Olive.ICmdSource.UpdateAll(this.m_docViewerAgg);}
function MainPage_onFitZoomChanged(oEvent)
{DHTML.setCookie(this.WebApplication.m_sFitMode_Cookie,oEvent.sFitMode);}
function MainPage_onPrintDocument()
{var oWindowOptions=new Olive.Data.PopupWindowOptions();oWindowOptions.target="popup_printForm";oWindowOptions.setHeight(387);oWindowOptions.setWidth(340);oWindowOptions.setTitle("Print Document");oWindowOptions.setIsResizable(false);var printFormData=this.m_docViewerAgg.PreparePrintData();if(!printFormData)
return;var callbackOnClose=Delegate.CreateDelegate(this._PrintDocumentPages,this);this.openPopup("PrintPagesForm.htm",oWindowOptions,printFormData,callbackOnClose,true);}
function MainPage_onSendMail()
{var contentItem=this._getContentItem();this.WebApplication.SendItemByMail(contentItem,false,null,this.m_docViewerAgg);}
function MainPage_onAddMailAlert()
{var oWindowOptions=new Olive.Data.PopupWindowOptions();oWindowOptions.target="popup_AddMailAlert";oWindowOptions.setHeight(350);oWindowOptions.setWidth(500);oWindowOptions.setTitle("Add e-Mail Alert");oWindowOptions.setIsResizable(false);var contentItem=this._getContentItem();var docHref=contentItem.getDocHRef();this.openPopup("CreateEmailAlert.aspx?docHref="+docHref,oWindowOptions,null,null,true);}
function MainPage_onShowMyArticles()
{var oWindowOptions=new Olive.Data.PopupWindowOptions();oWindowOptions.target="popup_MyArticles";oWindowOptions.setHeight(600);oWindowOptions.setWidth(700);oWindowOptions.setTitle("My Articles");oWindowOptions.setIsResizable(true);var contentItem=this._getContentItem();var docHref=contentItem.getDocHRef();this.openPopup("MyArticles.aspx?docHref="+docHref,oWindowOptions,null,null,true);}
function MainPage_onCopyLink()
{this.WebApplication.copyItemToClipboard(this.m_docViewerAgg);}
function MainPage_onAddToFavorites()
{if(isMozilla())
{this.WebApplication._checkOkToBookmarkPageInFirefoxBrowser(this.m_docViewerAgg);}
this.WebApplication.addItemToFavorites(this.m_docViewerAgg);}
function MainPage_onDoBookmark(oCmdParams)
{var oSourceConrtrol=this.m_docViewerAgg;var oContentItem=this.m_docViewerAgg.getContentItem();this.WebApplication.createBookmark(oCmdParams,oContentItem,oSourceConrtrol);}
function MainPage_updateAddToFavoritesState(oCmdUiState)
{if(isSafari())
oCmdUiState.enableCommand(false);oCmdUiState.showCommand(this.WebApplication.m_bEnableBookmarkPage);}
function MainPage_onPDFDocDownload()
{var sLink=this.WebApplication.createPDFDownloadLink(this.m_flashViewer,OwcPDFDownloadItem_Doc,true);window.open(sLink,"DownloadPDF");}
function MainPage_onPDFPageDownload()
{var sLink=this.WebApplication.createPDFDownloadLink(this.m_flashViewer,OwcPDFDownloadItem_Page,true);window.open(sLink,"DownloadPagePDF");}
function MainPage_updatePDFPageState(oCmdUiState)
{var bEnableCommand=false;var bDownloadOnePagePDF=this.WebApplication.m_bDownloadOnePagePDF;oCmdUiState.showCommand(bDownloadOnePagePDF);if(bDownloadOnePagePDF&&this.m_flashViewer&&this.m_flashViewer.hasOnePagePDF()&&this.m_flashViewer.getDocumentLoaded())
bEnableCommand=true;oCmdUiState.enableCommand(bEnableCommand);}
function MainPage_updatePDFDocumentState(oCmdUiState)
{var bEnableCommand=false;var bDownloadPDF=this.WebApplication.m_bDownloadPDF;oCmdUiState.showCommand(bDownloadPDF);if(bDownloadPDF&&this.m_flashViewer&&this.m_flashViewer.hasDocumentPDF()&&this.m_flashViewer.getDocumentLoaded())
bEnableCommand=true;oCmdUiState.enableCommand(bEnableCommand);}
function MainPage_updateSendPageEmailState(oCmdUiState)
{oCmdUiState.showCommand(this.WebApplication.m_bEnableSendPageEmail);}
function MainPage_updateExternalBookmarkingDiggState(oCmdUiState)
{oCmdUiState.showCommand(this.WebApplication.m_bEnableExternalBookmarkingDigg);}
function MainPage_updateExternalBookmarkingDeliciousState(oCmdUiState)
{oCmdUiState.showCommand(this.WebApplication.m_bEnableExternalBookmarkingDelicious);}
function MainPage_updatePrintPageState(oCmdUiState)
{if(oCmdUiState.commandName=="printdocument")
oCmdUiState.showCommand(this.WebApplication.m_bEnablePrintPage);else
oCmdUiState.showCommand(this.WebApplication.m_bEnablePrintArea);}
function MainPage_updateCopyToClipboardPageState(oCmdUiState)
{oCmdUiState.showCommand(this.WebApplication.m_bEnableCopyToClipboardPage);}
function MainPage__updateSaveForOfflineState(oCmdUiState)
{var bEnableCommand=!isSafari();oCmdUiState.enableCommand(bEnableCommand);oCmdUiState.showCommand(this.WebApplication.m_bEnableSaveForOffline);}
function MainPage_updateEmailAlertsState(oCmdUiState)
{oCmdUiState.showCommand(this.WebApplication.m_bEnableEmailAlerts);}
function MainPage_updateShowMyArticlesState(oCmdUiState)
{oCmdUiState.showCommand(this.WebApplication.m_bEnableMyArticles);}
function MainPage_onSaveForOffline()
{var oContentItem=this._getContentItem();if(!oContentItem)
return;var sLinkTitle=this.WebApplication.getIssueName(oContentItem,"SWIssueShortDescription");var sDocHref=oContentItem.getDocHRef();if(sLinkTitle=="")
{sLinkTitle="Document "+sDocHref;}
var oArguments={SaveForOffline:true};var queryString=new QueryString();queryString.m_bBase64=this.WebApplication.m_bEncodeDecodeUrl;queryString.addParam("DocHRef",sDocHref);queryString.addParam("DocTitle",sLinkTitle);queryString.addParam("UniqueId",generateUniqueID());if(this.WebApplication.m_bEncodeDecodeUrl)
queryString.addParam(Olive.WebAppBase.UrlParam.IsURLEncoded,"1",true,true);var sURL="SaveForOffline.aspx?"+queryString.getQueryString();var oOptions=new Olive.Data.PopupWindowOptions();oOptions.target="popup_SaveForOffline";oOptions.setTitle("Save for Offline");oOptions.setIsResizable(false);oOptions.SaveForOffline=true;this.openPopup(sURL,oOptions,oArguments,null,true);}
function MainPage_onMoreIssues()
{var oWindowOptions=new Olive.Data.PopupWindowOptions();oWindowOptions.target=MainPage.ElementIDs.Popup_LibraryID;oWindowOptions.setMaximalHeightPercent(90);oWindowOptions.setHeight(this.WebApplication.getPreferenceNumber("popup-library-height",635));oWindowOptions.setWidth(this.WebApplication.getPreferenceNumber("popup-library-width",530));oWindowOptions.setTitle("More Publications and Issues");oWindowOptions.setIsResizable(false);var contentItem=this._getContentItem();if(!contentItem)
return;this.openPopup("",oWindowOptions,contentItem,null,true);this.m_oPublicationList=this.findControlByType(Olive.Controls.controlTypeNames.PublicationList);this.m_oYearList=this.findControlByType(Olive.Controls.controlTypeNames.YearList);if(!this.m_oYearList)
{this.reportError(DHTML.newError(-1,"Cannot find the Olive.Controls.controlTypeNames.YearList control on HTML page."));return;}
if(this.m_oLibraryThumbList)
{this.m_oLibraryThumbList.clearControls();this.m_oLibraryThumbList.HtmlElement.innerHTML="";var bAscOrder=this.WebApplication.getPreferenceBoolean("thumblist-asc-sort",false);this.m_oLibraryThumbList.sortBy("ISSUE_DATE",bAscOrder);}
if(this.m_oPopupWindow_Library)
{var nPopupHeight=DHTML.getElemHeight(this.m_oPopupWindow_Library.HtmlElement);var nTopBorderHeight=DHTML.getElemHeight(this.m_oPopupWindow_Library.getUiElement("popupwindowtopborder"));var nBottomBorderHeight=DHTML.getElemHeight(this.m_oPopupWindow_Library.getUiElement("popupwindowbottomborder"));var nCaptionHeight=DHTML.getElemHeight(this.m_oPopupWindow_Library.getUiElement("popupwindowcaption"));var oHeaderPublicationSelection=getObj("headerPublicationSelection");var oHeaderYearSelection=getObj("headerYearSelection");var nHeaderHeight=DHTML.getElemHeight(oHeaderPublicationSelection)+DHTML.getElemHeight(oHeaderYearSelection);var nPopupWidth=DHTML.getElemWidth(this.m_oPopupWindow_Library.HtmlElement);var nLeftBorderWidth=DHTML.getElemWidth(this.m_oPopupWindow_Library.getUiElement("popupwindowcontentleftborder"));var nRightBorderWidth=DHTML.getElemWidth(this.m_oPopupWindow_Library.getUiElement("popupwindowcontentrightborder"));var nConstantOffset=8;DHTML.setElemHeight(this.m_oLibraryThumbList.HtmlElement,nPopupHeight-nTopBorderHeight-nBottomBorderHeight-nCaptionHeight-nHeaderHeight-nConstantOffset);DHTML.setElemWidth(this.m_oLibraryThumbList.HtmlElement,nPopupWidth-nLeftBorderWidth-nRightBorderWidth-nConstantOffset);}
var sPublication="";var sYear="";if(!contentItem)
return;if(contentItem.m_sDocHRef&&contentItem.m_sDocHRef!=="")
{var nFirstSlashIndex=contentItem.m_sDocHRef.indexOf("/");sPublication=contentItem.m_sDocHRef.substring(0,nFirstSlashIndex);var nSecondSlashIndex=contentItem.m_sDocHRef.indexOf("/",nFirstSlashIndex+1);sYear=contentItem.m_sDocHRef.substring(nFirstSlashIndex+1,nSecondSlashIndex);}
var oContentItemYearRange=Olive.ContentItem.CreateByType(OwcContentItem_YearRange);oContentItemYearRange.m_sPublication=sPublication;if(this.m_oPublicationList)
{Olive.Binding.BindContentsOnValueChanging.BindControls(this.m_oPublicationList,this.m_oYearList);}
Olive.Binding.BindContentsOnValueChanging.BindControls(this.m_oYearList,this.m_oLibraryThumbList);this.m_oLibraryThumbList.onSelectionItemClicked=Delegate.CreateDelegate(this._onThumbListSelectionChanged,this);var sDocHref=contentItem.getDocHRef();var sPublicationName=sDocHref.substring(0,sDocHref.indexOf("/"));if(!this.WebApplication.m_oCustomRequestParams)
this.WebApplication.m_oCustomRequestParams=new QueryString();this.WebApplication.m_oCustomRequestParams.addParam("CurrentPublicationName",sPublicationName);if(this.m_oPublicationList)
{this.m_oPublicationList.contentLoad();}
this.m_oYearList.m_oContentItem=oContentItemYearRange;this.m_oYearList.contentLoad();if(this.m_magnifierControl)
{this.m_magnifierControl.setMaxWidth(this.WebApplication.m_nMagnifierMaxWidth);this.m_magnifierControl.setMaxHeight(this.WebApplication.m_nMagnifierMaxHeight);this.m_magnifierControl.setMagPercent(this.WebApplication.m_nMagnifierMagPercent);}}
function MainPage_onNavigationPaneVisibilityChanged(eventArgs)
{var oDocViewer=this.m_docViewerAgg;var oNavTabStrip=oDocViewer.m_oNavTabStrip;var oNavPageSwitcher=this.m_oMainPageSwitcher;var bPaneVisible=eventArgs.bPaneVisible;if(!oNavTabStrip||!oNavPageSwitcher)
return;if(!bPaneVisible)
{var oActiveTabItem=oNavTabStrip.getActiveItem();if(oActiveTabItem)
{oActiveTabItem.changeState(false,oNavTabStrip.m_dwActiveItemState,oNavTabStrip.m_dwActiveItemStateMask);oNavTabStrip.m_iActiveItem=-1;}}
else
{var iActivePageItemIndex=oNavPageSwitcher.getActiveItemIndex();oNavTabStrip.setActiveItem(iActivePageItemIndex,true);}
if(this.m_bSideBannersExist)
{this._BannersVisibilityChanged(eventArgs);}}
function MainPage_PrintDocumentPages(dialogResult,returnValue,popupInfo)
{if(dialogResult==Olive.PopupInfo.DialogResult.Cancel)
return;var contentItem=this.m_docViewerAgg.getContentItem();var printData=new Olive.ContentItem.Print();printData.copyFrom(contentItem);printData.m_oPrintFormData=returnValue;this.openPopup("PrintPagesView.htm","popup_printDocumentView",printData,null,true);}
function MainPage_openAccessNotificationDialog(oPopupArgs)
{var callbackOnClose=Delegate.CreateDelegate(this.WebApplication._AccessNotificationCallback,this.WebApplication);this.openPopup("AccessNotificationDialog.htm","popup_AccessNotification",oPopupArgs,callbackOnClose,true);}
function MainPage_updateIFrame(eventArgs)
{var oPageItem=eventArgs.srcObject;if(!oPageItem||!oPageItem.get_HtmlElement)
return;var oFrame=getChildObjectByTag(oPageItem.get_HtmlElement(),"iframe");switch(oPageItem)
{case this.m_oPageItemHelp:oFrame.src=MainPage.IFrames.HelpIFrame;break;case this.m_oPageItemSearch:oFrame.src=MainPage.IFrames.SearchPane;break;}
oPageItem.detachOwcEventHandler("stateChanged",this._updateIFrame,this);}
function MainPage_importScripts(src)
{var scriptElem=document.createElement('script');scriptElem.setAttribute('src',src);scriptElem.setAttribute('type','text/javascript');document.getElementsByTagName('head')[0].appendChild(scriptElem);}
function MainPage_onContentsPaneResized(oEvent)
{var oContentsPane=document.getElementById(MainPage.ElementIDs.CtrlContentsPaneID);var oPageSwitcher=document.getElementById(MainPage.ElementIDs.MainPageSwitcherID);var oAllContents=document.getElementById(MainPage.ElementIDs.CtrlAllContentsID);oAllContents.style.width=oContentsPane.style.width;oAllContents.style.height=oContentsPane.style.height;oPageSwitcher.style.width=oContentsPane.style.width;oPageSwitcher.style.height=oContentsPane.style.height;var leftBanner=this.m_oBanners.Left;var rightBanner=this.m_oBanners.Right;if(!!leftBanner&&leftBanner.oPane.style.display.toLowerCase()=="block")
{leftBanner.oPane.style.height=oContentsPane.style.height;}
if(!!rightBanner&&rightBanner.oPane.style.display.toLowerCase()=="block")
{rightBanner.oPane.style.height=oContentsPane.style.height;}}
function MainPage_onPaneListRootResized(oEvent)
{if(this.m_bSideBannersExist&&this.m_oBorderLeftTable&&this.m_oBorderRightTable)
{if(isMozilla())
{this.m_oBorderLeftTable.style.height="100%";this.m_oBorderRightTable.style.height="100%";}
var leftBanner=this.m_oBanners.Left.oPane;var rightBanner=this.m_oBanners.Right.oPane;var leftBannerDisplay=leftBanner.style.display.toLowerCase();var rightBannerDisplay=rightBanner.style.display.toLowerCase();var oCtrlFlashViewer=document.getElementById("ctrlFlashViewer");if(leftBannerDisplay!="none"||rightBannerDisplay!="none"){var oPaneViewerFramesRoot=document.getElementById(MainPage.ElementIDs.PaneViewerFramesID);oCtrlFlashViewer.style.height=oPaneViewerFramesRoot.style.height;}else{oCtrlFlashViewer.style.height="";}}
if(oEvent.bResizedWithSplitter)
{DHTML.setCookie(this.WebApplication.sSplitterPosition_Cookie,this.m_oPaneViewerFramesRoot.getSplitterPaneProportion());}}
function MainPage_HideContentPane()
{if(this.m_docViewerAgg)
{this.m_docViewerAgg._HideNavigationPane();}}
function MainPage_BannersVisibilityChanged(oNavPaneVisibilityChangedArgs)
{if(this.m_oBanners.Right.oPane&&this.m_oBanners.Left.oPane)
{if(!oNavPaneVisibilityChangedArgs.bPaneVisible)
{if(this._checkDimension(this.m_oBanners.Right.nHeight)&&this._checkDimension(this.m_oBanners.Right.nWidth))
{this.m_oBanners.Right.oPane.style.display=this.m_sDisplayStyle;}
if(this._checkDimension(this.m_oBanners.Left.nHeight)&&this._checkDimension(this.m_oBanners.Left.nWidth))
{this.m_oBanners.Left.oPane.style.display=this.m_sDisplayStyle;}}
if(oNavPaneVisibilityChangedArgs.bPaneVisible)
{this.m_oBanners.Right.oPane.style.display="none";this.m_oBanners.Left.oPane.style.display="none";}}}
function MainPage_OpenOliveSoftwareWebsite()
{window.open("http://www.olivesoftware.com/faqs/","_blank","toolbar=yes, location=yes, directories=yes, status=yes, menubar=yes, scrollbars=yes, resizable=yes, copyhistory=yes, width=930, height=750");}
function MainPage_setFitMode()
{var sFitMode=this.WebApplication.m_sFitMode;var sFitMode_FromCookie=DHTML.getCookie(this.WebApplication.m_sFitMode_Cookie);if(sFitMode_FromCookie!=null)
sFitMode=sFitMode_FromCookie;if(sFitMode==Olive.Controls.Viewer.FitMode.Width)
this.m_flashViewer.zoomFitWidth();else
this.m_flashViewer.zoomFitWindow();}
function MainPage_onFullScreenChanged(oEvent)
{if(oEvent.bFullScreenMode)
{this.m_flashViewer.cmdChangeModeDoublePage(this.m_docViewerAgg.get_GlobalDoublePageMode());if(this.m_docViewerAgg.get_DoubleModeOnGotopage())
this.m_docViewerAgg.CancelDoubleModeOnGotopage();}
else
{var bDoublePageMode=this.m_flashViewer.getModeDoublePage();this.m_docViewerAgg.set_GlobalDoublePageMode(bDoublePageMode);DHTML.setCookie(this.WebApplication.m_sDoublePageMode_Cookie,bDoublePageMode);if(this.m_docViewerAgg.m_oNavigationPane.isVisible()&&bDoublePageMode)
{this.m_docViewerAgg.m_oViewerCtrl.cmdChangeModeDoublePage(false);}
if(this.m_docViewerAgg.get_DoubleModeOnGotopage())
this.m_docViewerAgg.ApplyDoubleModeOnGotopage();}}
function MainPage_refreshBanners(oEvent)
{JScript_Timeout.setTimeout(this._doRefreshBanners,100,this,null);}
function MainPage_doRefreshBanners()
{this._refreshIFrame(this.m_oBanners.Top);this._refreshIFrame(this.m_oBanners.Left);this._refreshIFrame(this.m_oBanners.Right);}
function MainPage_refreshIFrame(oBanner)
{if(!oBanner.oIFrame)
return;if(parseInt(oBanner.nHeight,10)>0&&parseInt(oBanner.nWidth,10)>0)
{if(oBanner.bRefresh)
{if(DHTML.getStyle(oBanner.oPane,"display")=="block"||DHTML.getStyle(oBanner.oPane,"display")=="table-cell")
{var sIFrameSrc=oBanner.oIFrame.src;oBanner.oIFrame.src="";oBanner.oIFrame.src=sIFrameSrc;}}}}
function MainPage_openCopyToClipboardPopup(sLinkUrl)
{var oWindowOptions=new Olive.Data.PopupWindowOptions();oWindowOptions.target=MainPage.ElementIDs.Popup_CopyLinkToClipboard;oWindowOptions.setIsResizable(false);oWindowOptions.setHeight(170);oWindowOptions.setWidth(450);oWindowOptions.setTitle(this.getResString("PopupInfo_CopyLinkToClipboard_Title"));var oCopyLinkToClipboardText=document.getElementById(MainPage.ElementIDs.Popup_CopyLinkToClipboard_Text);var sText="";if(isMacintosh())
sText=this.getResString("PopupInfo_CopyLinkToClipboard_Text_Mac");else
sText=this.getResString("PopupInfo_CopyLinkToClipboard_Text_Windows");DHTML.pasteHtmlContent(oCopyLinkToClipboardText,sText);this.openPopup("",oWindowOptions,null,null,true);try
{var ctrlCopyToClipboardUrl=OwcGetControl("PopupInfo_CopyLinkToClipboard_Url");ctrlCopyToClipboardUrl.setValue(sLinkUrl);ctrlCopyToClipboardUrl.HtmlElement.focus();ctrlCopyToClipboardUrl.HtmlElement.select();}
catch(ex){}}
function MainPage_closeCopyLinkToClipboardPopup()
{this.m_CopyLinkToClipBoardPopup.close();}
function MainPage_onPrintPageArea(pageNum)
{if(this.m_flashViewer&&this.m_flashViewer.hasOnePagePDF()&&this.m_flashViewer.getDocumentLoaded())
{if(!pageNum&&this.m_docViewerAgg.m_oContentItem.m_nNumPagesDisplayed>1)
{var oWindowOptions=new Olive.Data.PopupWindowOptions();oWindowOptions.target=MainPage.ElementIDs.PopupWindow_SelectPageToPrintID;oWindowOptions.setIsResizable(false);oWindowOptions.setHeight(140);oWindowOptions.setWidth(350);oWindowOptions.setTitle("Select page to print");this.openPopup("",oWindowOptions,this.m_docViewerAgg,null,true);}
else
{var targetUrl="CropAndPrint.aspx"
+"?baseHRef="+this.m_docViewerAgg.m_oContentItem.m_sDocHRef
+"&pageNo="+((!pageNum||pageNum==1)?this.m_docViewerAgg.m_oContentItem.m_nPageNo:this.m_docViewerAgg.m_oContentItem.m_nSecondPageNo);window.open(targetUrl,null,"resizable=yes,scrollbars=yes,resizable=yes,status=yes,toolbar=no,menubar=no,location=no,width=700,height=850,top=0,left=0");}}
else
{this._onPrintDocument();}
return;}
function MainPage_onPrintPageArea_LeftPage()
{this.m_oPopupWindow_SelectPageToPrint.close();this._onPrintPageArea(1);}
function MainPage_onPrintPageArea_RightPage()
{this.m_oPopupWindow_SelectPageToPrint.close();this._onPrintPageArea(2);}
JScript.Type.RegisterClass("MainPage",MainPage,Olive.Page);}
Olive.WindowBinder.RegisterPageClass(window,MainPage);{function Delta_MainPage()
{}
var BannerIterationCount=-1;var BannerIteration=2;var currentSection="";Delta_MainPage.Commands={OpenWebsite:"OpenWebsite",USAWButton:"USAWButton"};Delta_MainPage.DeclareType=function Delta_MainPage_DeclareType()
{this.DeclareMethod("refreshOmnitute",Delta_MainPage_refreshOmnitute);this.OverrideMethod("onPageTurned",Delta_MainPage_refreshBanners);this.OverrideMethod("onGatefoldStatusChanged",Delta_MainPage_refreshBanners);this.DeclareMethod("_OpenWebsite",Delta_MainPage_OpenWebsite);this.DeclareMethod("_onUSAWButton",Delta_MainPage_onUSAWButton);this.OverrideMethod("_doRefreshBanners",Delta_MainPage_doRefreshBanners);}
Delta_MainPage.ApplyPrototype=function Delta_MainPage_ApplyPrototype(classProto)
{Olive.CmdTarget.RegisterCommand(classProto,Delta_MainPage.Commands.OpenWebsite,"_OpenWebsite");Olive.CmdTarget.RegisterCommand(classProto,Delta_MainPage.Commands.USAWButton,"_onUSAWButton");};function Delta_MainPage_OpenWebsite(sWebSite)
{window.open(sWebSite,"_blank","toolbar=yes, location=yes, directories=yes, status=yes, menubar=yes, scrollbars=yes, resizable=yes, copyhistory=yes, width=930, height=750");}
function Delta_MainPage_refreshOmnitute()
{var oOmnitureIFrame=document.getElementById("omnitureIFrame");if(oOmnitureIFrame)
{var randomnumber=Math.floor(Math.random()*10001);var sIFrameSrc="omniture.htm";oOmnitureIFrame.src="";oOmnitureIFrame.src=sIFrameSrc+"?"+randomnumber;}}
function Delta_MainPage_onUSAWButton()
{window.open("http://www.usaweekend.com/content/ebook/denver_post/","_blank","toolbar=yes, location=yes, directories=yes, status=yes, menubar=yes, scrollbars=yes, resizable=yes, copyhistory=yes");}
function Delta_MainPage_refreshBanners(oEvent)
{this.refreshOmnitute();JScript_Timeout.setTimeout(this._doRefreshBanners,100,this,null);}
function Delta_MainPage_doRefreshBanners(){BannerIterationCount++;if(BannerIterationCount>=BannerIteration){BannerIterationCount=0;this._refreshIFrame(this.m_oBanners.Top);this._refreshIFrame(this.m_oBanners.Left);this._refreshIFrame(this.m_oBanners.Right);}}
JScript.Type.RegisterClass("Delta_MainPage",Delta_MainPage,MainPage);}
Olive.WindowBinder.RegisterPageClass(window,Delta_MainPage);